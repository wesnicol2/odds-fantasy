import requests
from pprint import pprint

# TheOddsAPI configuration
API_KEY = ''  # Replace with your TheOddsAPI key
BASE_URL = 'https://api.the-odds-api.com/v4'
EVENTS_URL = f'{BASE_URL}/sports/americanfootball_nfl/events'

def get_nfl_events(api_key=API_KEY, regions='us'):
    """
    Fetches upcoming NFL events (games) with event IDs from TheOddsAPI.
    
    Args:
        api_key (str): TheOddsAPI key for authentication.
        regions (str): The region for odds (default is 'us').
    
    Returns:
        list: A list of NFL events with event IDs.
    """
    
    url = f"{EVENTS_URL}?apiKey={api_key}&regions={regions}"
    response = requests.get(url)
    response.raise_for_status()
    events = response.json()  # Parse the response as JSON
    return events


def get_event_player_odds(event_id, api_key=API_KEY, regions='us', markets='player_rush_yds,player_reception_yds,player_pass_tds,player_pass_yds'):
    """
    Fetches player-specific odds for a given NFL event using the event-odds endpoint.
    
    Args:
        api_key (str): TheOddsAPI key for authentication.
        event_id (str): The event ID of the NFL game.
        regions (str): The region for odds (default is 'us').
        markets (str): The player prop markets to fetch (e.g., rushing yards, passing touchdowns).
    
    Returns:
        dict: Odds data for players in the specific NFL event.
    """
    EVENT_ODDS_URL = f'{BASE_URL}/sports/americanfootball_nfl/events'
    url = f"{EVENT_ODDS_URL}/{event_id}/odds?apiKey={api_key}&regions={regions}&markets={markets}"
    # response = requests.get(url)
    # response.raise_for_status()  # Check for a successful response
    # event_odds = response.json()  # Parse the response as JSON
    event_odds = {"id":"8e047915fdc9b7dc77d2276e740f55d2","sport_key":"americanfootball_nfl","sport_title":"NFL","commence_time":"2024-09-24T00:15:00Z","home_team":"Cincinnati Bengals","away_team":"Washington Commanders","bookmakers":[{"key":"draftkings","title":"DraftKings","markets":[{"key":"player_pass_tds","last_update":"2024-09-22T02:07:33Z","outcomes":[{"name":"Over","description":"Jayden Daniels","price":2.85,"point":1.5},{"name":"Under","description":"Jayden Daniels","price":1.41,"point":1.5},{"name":"Over","description":"Joe Burrow","price":1.65,"point":1.5},{"name":"Under","description":"Joe Burrow","price":2.2,"point":1.5}]},{"key":"player_pass_yds","last_update":"2024-09-22T02:07:33Z","outcomes":[{"name":"Over","description":"Jayden Daniels","price":1.87,"point":196.5},{"name":"Under","description":"Jayden Daniels","price":1.87,"point":196.5},{"name":"Over","description":"Joe Burrow","price":1.91,"point":263.5},{"name":"Under","description":"Joe Burrow","price":1.83,"point":263.5}]},{"key":"player_reception_yds","last_update":"2024-09-22T02:07:33Z","outcomes":[{"name":"Over","description":"Andrei Iosivas","price":1.87,"point":26.5},{"name":"Under","description":"Andrei Iosivas","price":1.87,"point":26.5},{"name":"Over","description":"Brian Robinson Jr.","price":1.91,"point":11.5},{"name":"Under","description":"Brian Robinson Jr.","price":1.83,"point":11.5},{"name":"Over","description":"Chase Brown","price":1.87,"point":9.5},{"name":"Under","description":"Chase Brown","price":1.87,"point":9.5},{"name":"Over","description":"Ja\'Marr Chase","price":1.87,"point":81.5},{"name":"Under","description":"Ja\'Marr Chase","price":1.87,"point":81.5},{"name":"Over","description":"Mike Gesicki","price":1.91,"point":27.5},{"name":"Under","description":"Mike Gesicki","price":1.83,"point":27.5},{"name":"Over","description":"Tee Higgins","price":1.87,"point":44.5},{"name":"Under","description":"Tee Higgins","price":1.87,"point":44.5},{"name":"Over","description":"Terry McLaurin","price":1.83,"point":48.5},{"name":"Under","description":"Terry McLaurin","price":1.91,"point":48.5},{"name":"Over","description":"Zach Ertz","price":2.05,"point":26.5},{"name":"Under","description":"Zach Ertz","price":1.74,"point":26.5},{"name":"Over","description":"Zack Moss","price":1.83,"point":12.5},{"name":"Under","description":"Zack Moss","price":1.91,"point":12.5}]},{"key":"player_rush_yds","last_update":"2024-09-22T02:07:33Z","outcomes":[{"name":"Over","description":"Brian Robinson Jr.","price":1.87,"point":54.5},{"name":"Under","description":"Brian Robinson Jr.","price":1.87,"point":54.5},{"name":"Over","description":"Chase Brown","price":1.91,"point":24.5},{"name":"Under","description":"Chase Brown","price":1.83,"point":24.5},{"name":"Over","description":"Jayden Daniels","price":1.87,"point":49.5},{"name":"Under","description":"Jayden Daniels","price":1.87,"point":49.5},{"name":"Over","description":"Joe Burrow","price":1.95,"point":12.5},{"name":"Under","description":"Joe Burrow","price":1.8,"point":12.5},{"name":"Over","description":"Zack Moss","price":1.91,"point":52.5},{"name":"Under","description":"Zack Moss","price":1.83,"point":52.5}]}]},{"key":"williamhill_us","title":"Caesars","markets":[{"key":"player_pass_tds","last_update":"2024-09-22T02:06:55Z","outcomes":[{"name":"Over","description":"Joe Burrow","price":1.62,"point":1.5},{"name":"Under","description":"Joe Burrow","price":2.16,"point":1.5},{"name":"Over","description":"Jayden Daniels","price":2.84,"point":1.5},{"name":"Under","description":"Jayden Daniels","price":1.38,"point":1.5}]},{"key":"player_pass_yds","last_update":"2024-09-22T02:06:55Z","outcomes":[{"name":"Over","description":"Jayden Daniels","price":1.85,"point":195.5},{"name":"Under","description":"Jayden Daniels","price":1.85,"point":195.5},{"name":"Over","description":"Joe Burrow","price":1.92,"point":264.5},{"name":"Under","description":"Joe Burrow","price":1.8,"point":264.5}]},{"key":"player_reception_yds","last_update":"2024-09-22T02:06:55Z","outcomes":[{"name":"Over","description":"Mike Gesicki","price":1.85,"point":28.5},{"name":"Under","description":"Mike Gesicki","price":1.85,"point":28.5},{"name":"Over","description":"Andrei Iosivas","price":1.87,"point":26.5},{"name":"Under","description":"Andrei Iosivas","price":1.84,"point":26.5},{"name":"Over","description":"Terry McLaurin","price":1.83,"point":50.5},{"name":"Under","description":"Terry McLaurin","price":1.88,"point":50.5},{"name":"Over","description":"Ja\'Marr Chase","price":1.8,"point":79.5},{"name":"Under","description":"Ja\'Marr Chase","price":1.92,"point":79.5},{"name":"Over","description":"Zack Moss","price":1.88,"point":12.5},{"name":"Under","description":"Zack Moss","price":1.83,"point":12.5},{"name":"Over","description":"Brian Robinson Jr.","price":1.87,"point":11.5},{"name":"Under","description":"Brian Robinson Jr.","price":1.84,"point":11.5},{"name":"Over","description":"Tee Higgins","price":1.84,"point":45.5},{"name":"Under","description":"Tee Higgins","price":1.87,"point":45.5},{"name":"Over","description":"Zach Ertz","price":1.96,"point":26.5},{"name":"Under","description":"Zach Ertz","price":1.76,"point":26.5}]},{"key":"player_rush_yds","last_update":"2024-09-22T02:06:55Z","outcomes":[{"name":"Over","description":"Chase Brown","price":1.93,"point":25.5},{"name":"Under","description":"Chase Brown","price":1.79,"point":25.5},{"name":"Over","description":"Jayden Daniels","price":1.84,"point":51.5},{"name":"Under","description":"Jayden Daniels","price":1.87,"point":51.5},{"name":"Over","description":"Brian Robinson Jr.","price":1.84,"point":53.5},{"name":"Under","description":"Brian Robinson Jr.","price":1.87,"point":53.5},{"name":"Over","description":"Joe Burrow","price":1.94,"point":12.5},{"name":"Under","description":"Joe Burrow","price":1.78,"point":12.5},{"name":"Over","description":"Zack Moss","price":1.9,"point":51.5},{"name":"Under","description":"Zack Moss","price":1.81,"point":51.5}]}]},{"key":"fanduel","title":"FanDuel","markets":[{"key":"player_pass_tds","last_update":"2024-09-22T02:06:53Z","outcomes":[{"name":"Over","description":"Jayden Daniels","price":1.37,"point":0.5},{"name":"Under","description":"Jayden Daniels","price":2.98,"point":0.5},{"name":"Over","description":"Joe Burrow","price":1.62,"point":1.5},{"name":"Under","description":"Joe Burrow","price":2.22,"point":1.5}]},{"key":"player_pass_yds","last_update":"2024-09-22T02:06:53Z","outcomes":[{"name":"Over","description":"Jayden Daniels","price":1.88,"point":197.5},{"name":"Under","description":"Jayden Daniels","price":1.88,"point":197.5},{"name":"Over","description":"Joe Burrow","price":1.88,"point":261.5},{"name":"Under","description":"Joe Burrow","price":1.88,"point":261.5}]},{"key":"player_reception_yds","last_update":"2024-09-22T02:06:53Z","outcomes":[{"name":"Over","description":"Mike Gesicki","price":1.88,"point":25.5},{"name":"Under","description":"Mike Gesicki","price":1.88,"point":25.5},{"name":"Over","description":"Tee Higgins","price":1.88,"point":43.5},{"name":"Under","description":"Tee Higgins","price":1.88,"point":43.5},{"name":"Over","description":"Zach Ertz","price":1.88,"point":25.5},{"name":"Under","description":"Zach Ertz","price":1.88,"point":25.5},{"name":"Over","description":"Chase Brown","price":1.88,"point":9.5},{"name":"Under","description":"Chase Brown","price":1.88,"point":9.5},{"name":"Over","description":"Terry McLaurin","price":1.88,"point":48.5},{"name":"Under","description":"Terry McLaurin","price":1.88,"point":48.5},{"name":"Over","description":"Ja\'Marr Chase","price":1.88,"point":80.5},{"name":"Under","description":"Ja\'Marr Chase","price":1.88,"point":80.5},{"name":"Over","description":"Brian Robinson Jr.","price":1.88,"point":10.5},{"name":"Under","description":"Brian Robinson Jr.","price":1.88,"point":10.5},{"name":"Over","description":"Zack Moss","price":1.88,"point":13.5},{"name":"Under","description":"Zack Moss","price":1.88,"point":13.5}]},{"key":"player_rush_yds","last_update":"2024-09-22T02:06:53Z","outcomes":[{"name":"Over","description":"Chase Brown","price":1.88,"point":24.5},{"name":"Under","description":"Chase Brown","price":1.88,"point":24.5},{"name":"Over","description":"Jayden Daniels","price":1.88,"point":46.5},{"name":"Under","description":"Jayden Daniels","price":1.88,"point":46.5},{"name":"Over","description":"Zack Moss","price":1.88,"point":50.5},{"name":"Under","description":"Zack Moss","price":1.88,"point":50.5},{"name":"Over","description":"Brian Robinson Jr.","price":1.88,"point":53.5},{"name":"Under","description":"Brian Robinson Jr.","price":1.88,"point":53.5},{"name":"Over","description":"Joe Burrow","price":1.88,"point":11.5},{"name":"Under","description":"Joe Burrow","price":1.88,"point":11.5}]}]},{"key":"betrivers","title":"BetRivers","markets":[{"key":"player_pass_tds","last_update":"2024-09-22T02:06:59Z","outcomes":[{"name":"Over","description":"Joe Burrow","price":1.73,"point":1.5},{"name":"Under","description":"Joe Burrow","price":2.06,"point":1.5},{"name":"Over","description":"Jayden Daniels","price":1.36,"point":0.5},{"name":"Under","description":"Jayden Daniels","price":2.9,"point":0.5}]},{"key":"player_pass_yds","last_update":"2024-09-22T02:06:59Z","outcomes":[{"name":"Over","description":"Joe Burrow","price":1.88,"point":263.5},{"name":"Under","description":"Joe Burrow","price":1.87,"point":263.5},{"name":"Over","description":"Joe Burrow","price":1.21,"point":219.5},{"name":"Under","description":"Joe Burrow","price":3.95,"point":219.5},{"name":"Over","description":"Joe Burrow","price":1.79,"point":259.5},{"name":"Under","description":"Joe Burrow","price":1.97,"point":259.5},{"name":"Over","description":"Jayden Daniels","price":3.7,"point":239.5},{"name":"Under","description":"Jayden Daniels","price":1.24,"point":239.5},{"name":"Over","description":"Joe Burrow","price":1.3,"point":229.5},{"name":"Under","description":"Joe Burrow","price":3.2,"point":229.5},{"name":"Over","description":"Joe Burrow","price":2.35,"point":279.5},{"name":"Under","description":"Joe Burrow","price":1.55,"point":279.5},{"name":"Over","description":"Jayden Daniels","price":3.1,"point":229.5},{"name":"Under","description":"Jayden Daniels","price":1.33,"point":229.5},{"name":"Over","description":"Jayden Daniels","price":1.93,"point":199.5},{"name":"Under","description":"Jayden Daniels","price":1.83,"point":199.5},{"name":"Over","description":"Jayden Daniels","price":1.36,"point":169.5},{"name":"Under","description":"Jayden Daniels","price":2.95,"point":169.5},{"name":"Over","description":"Joe Burrow","price":2.75,"point":289.5},{"name":"Under","description":"Joe Burrow","price":1.4,"point":289.5},{"name":"Over","description":"Joe Burrow","price":1.6,"point":249.5},{"name":"Under","description":"Joe Burrow","price":2.28,"point":249.5},{"name":"Over","description":"Jayden Daniels","price":2.23,"point":209.5},{"name":"Under","description":"Jayden Daniels","price":1.61,"point":209.5},{"name":"Over","description":"Jayden Daniels","price":1.5,"point":179.5},{"name":"Under","description":"Jayden Daniels","price":2.45,"point":179.5},{"name":"Over","description":"Jayden Daniels","price":1.25,"point":159.5},{"name":"Under","description":"Jayden Daniels","price":3.6,"point":159.5},{"name":"Over","description":"Joe Burrow","price":1.43,"point":239.5},{"name":"Under","description":"Joe Burrow","price":2.65,"point":239.5},{"name":"Over","description":"Jayden Daniels","price":2.6,"point":219.5},{"name":"Under","description":"Jayden Daniels","price":1.45,"point":219.5},{"name":"Over","description":"Jayden Daniels","price":1.7,"point":189.5},{"name":"Under","description":"Jayden Daniels","price":2.1,"point":189.5},{"name":"Over","description":"Joe Burrow","price":3.3,"point":299.5},{"name":"Under","description":"Joe Burrow","price":1.29,"point":299.5},{"name":"Over","description":"Joe Burrow","price":2.06,"point":269.5},{"name":"Under","description":"Joe Burrow","price":1.73,"point":269.5},{"name":"Over","description":"Joe Burrow","price":4.0,"point":309.5},{"name":"Under","description":"Joe Burrow","price":1.21,"point":309.5},{"name":"Over","description":"Jayden Daniels","price":1.88,"point":197.5},{"name":"Under","description":"Jayden Daniels","price":1.88,"point":197.5}]},{"key":"player_reception_yds","last_update":"2024-09-22T02:06:59Z","outcomes":[{"name":"Over","description":"Mike Gesicki","price":1.85,"point":27.5},{"name":"Under","description":"Mike Gesicki","price":1.89,"point":27.5},{"name":"Over","description":"Mike Gesicki","price":2.0,"point":29.5},{"name":"Under","description":"Mike Gesicki","price":1.78,"point":29.5},{"name":"Over","description":"Ja\'Marr Chase","price":1.87,"point":80.5},{"name":"Under","description":"Ja\'Marr Chase","price":1.88,"point":80.5},{"name":"Over","description":"Brian Robinson Jr.","price":1.89,"point":11.5},{"name":"Under","description":"Brian Robinson Jr.","price":1.85,"point":11.5},{"name":"Over","description":"Terry McLaurin","price":1.87,"point":48.5},{"name":"Under","description":"Terry McLaurin","price":1.88,"point":48.5},{"name":"Over","description":"Ja\'Marr Chase","price":1.83,"point":79.5},{"name":"Under","description":"Ja\'Marr Chase","price":1.92,"point":79.5},{"name":"Over","description":"Zach Ertz","price":2.14,"point":29.5},{"name":"Under","description":"Zach Ertz","price":1.68,"point":29.5},{"name":"Over","description":"Ja\'Marr Chase","price":3.55,"point":109.5},{"name":"Under","description":"Ja\'Marr Chase","price":1.26,"point":109.5},{"name":"Over","description":"Ja\'Marr Chase","price":1.43,"point":64.5},{"name":"Under","description":"Ja\'Marr Chase","price":2.65,"point":64.5},{"name":"Over","description":"Ja\'Marr Chase","price":3.1,"point":104.5},{"name":"Under","description":"Ja\'Marr Chase","price":1.32,"point":104.5},{"name":"Over","description":"Terry McLaurin","price":3.75,"point":74.5},{"name":"Under","description":"Terry McLaurin","price":1.24,"point":74.5},{"name":"Over","description":"Terry McLaurin","price":2.8,"point":64.5},{"name":"Under","description":"Terry McLaurin","price":1.4,"point":64.5},{"name":"Over","description":"Ja\'Marr Chase","price":1.26,"point":54.5},{"name":"Under","description":"Ja\'Marr Chase","price":3.55,"point":54.5},{"name":"Over","description":"Zach Ertz","price":1.79,"point":24.5},{"name":"Under","description":"Zach Ertz","price":1.97,"point":24.5},{"name":"Over","description":"Ja\'Marr Chase","price":2.75,"point":99.5},{"name":"Under","description":"Ja\'Marr Chase","price":1.4,"point":99.5},{"name":"Over","description":"Ja\'Marr Chase","price":1.55,"point":69.5},{"name":"Under","description":"Ja\'Marr Chase","price":2.35,"point":69.5},{"name":"Over","description":"Mike Gesicki","price":3.45,"point":44.5},{"name":"Under","description":"Mike Gesicki","price":1.27,"point":44.5},{"name":"Over","description":"Terry McLaurin","price":1.28,"point":29.5},{"name":"Under","description":"Terry McLaurin","price":3.35,"point":29.5},{"name":"Over","description":"Mike Gesicki","price":2.35,"point":34.5},{"name":"Under","description":"Mike Gesicki","price":1.55,"point":34.5},{"name":"Over","description":"Terry McLaurin","price":2.45,"point":59.5},{"name":"Under","description":"Terry McLaurin","price":1.5,"point":59.5},{"name":"Over","description":"Ja\'Marr Chase","price":1.68,"point":74.5},{"name":"Under","description":"Ja\'Marr Chase","price":2.12,"point":74.5},{"name":"Over","description":"Brian Robinson Jr.","price":3.55,"point":19.5},{"name":"Under","description":"Brian Robinson Jr.","price":1.26,"point":19.5},{"name":"Over","description":"Zach Ertz","price":2.55,"point":34.5},{"name":"Under","description":"Zach Ertz","price":1.47,"point":34.5},{"name":"Over","description":"Mike Gesicki","price":2.8,"point":39.5},{"name":"Under","description":"Mike Gesicki","price":1.38,"point":39.5},{"name":"Over","description":"Terry McLaurin","price":2.17,"point":54.5},{"name":"Under","description":"Terry McLaurin","price":1.65,"point":54.5},{"name":"Over","description":"Mike Gesicki","price":1.68,"point":24.5},{"name":"Under","description":"Mike Gesicki","price":2.12,"point":24.5},{"name":"Over","description":"Terry McLaurin","price":1.71,"point":44.5},{"name":"Under","description":"Terry McLaurin","price":2.08,"point":44.5},{"name":"Over","description":"Mike Gesicki","price":1.44,"point":19.5},{"name":"Under","description":"Mike Gesicki","price":2.6,"point":19.5},{"name":"Over","description":"Terry McLaurin","price":1.92,"point":49.5},{"name":"Under","description":"Terry McLaurin","price":1.83,"point":49.5},{"name":"Over","description":"Ja\'Marr Chase","price":2.04,"point":84.5},{"name":"Under","description":"Ja\'Marr Chase","price":1.75,"point":84.5},{"name":"Over","description":"Zach Ertz","price":3.1,"point":39.5},{"name":"Under","description":"Zach Ertz","price":1.32,"point":39.5},{"name":"Over","description":"Zach Ertz","price":1.51,"point":19.5},{"name":"Under","description":"Zach Ertz","price":2.45,"point":19.5},{"name":"Over","description":"Ja\'Marr Chase","price":2.48,"point":94.5},{"name":"Under","description":"Ja\'Marr Chase","price":1.49,"point":94.5},{"name":"Over","description":"Terry McLaurin","price":1.4,"point":34.5},{"name":"Under","description":"Terry McLaurin","price":2.8,"point":34.5},{"name":"Over","description":"Terry McLaurin","price":1.54,"point":39.5},{"name":"Under","description":"Terry McLaurin","price":2.38,"point":39.5},{"name":"Over","description":"Ja\'Marr Chase","price":2.25,"point":89.5},{"name":"Under","description":"Ja\'Marr Chase","price":1.6,"point":89.5},{"name":"Over","description":"Ja\'Marr Chase","price":1.34,"point":59.5},{"name":"Under","description":"Ja\'Marr Chase","price":3.05,"point":59.5},{"name":"Over","description":"Zach Ertz","price":3.85,"point":44.5},{"name":"Under","description":"Zach Ertz","price":1.23,"point":44.5},{"name":"Over","description":"Terry McLaurin","price":3.2,"point":69.5},{"name":"Under","description":"Terry McLaurin","price":1.3,"point":69.5},{"name":"Over","description":"Zack Moss","price":2.8,"point":19.5},{"name":"Under","description":"Zack Moss","price":1.4,"point":19.5},{"name":"Over","description":"Zack Moss","price":1.85,"point":13.5},{"name":"Under","description":"Zack Moss","price":1.89,"point":13.5},{"name":"Over","description":"Ja\'Marr Chase","price":4.0,"point":114.5},{"name":"Under","description":"Ja\'Marr Chase","price":1.2,"point":114.5},{"name":"Over","description":"Tee Higgins","price":3.85,"point":69.5},{"name":"Under","description":"Tee Higgins","price":1.23,"point":69.5},{"name":"Over","description":"Tee Higgins","price":2.8,"point":59.5},{"name":"Under","description":"Tee Higgins","price":1.4,"point":59.5},{"name":"Over","description":"Tee Higgins","price":1.47,"point":34.5},{"name":"Under","description":"Tee Higgins","price":2.55,"point":34.5},{"name":"Over","description":"Tee Higgins","price":3.25,"point":64.5},{"name":"Under","description":"Tee Higgins","price":1.3,"point":64.5},{"name":"Over","description":"Tee Higgins","price":1.64,"point":39.5},{"name":"Under","description":"Tee Higgins","price":2.18,"point":39.5},{"name":"Over","description":"Tee Higgins","price":2.14,"point":49.5},{"name":"Under","description":"Tee Higgins","price":1.68,"point":49.5},{"name":"Over","description":"Tee Higgins","price":1.85,"point":44.5},{"name":"Under","description":"Tee Higgins","price":1.89,"point":44.5},{"name":"Over","description":"Tee Higgins","price":2.43,"point":54.5},{"name":"Under","description":"Tee Higgins","price":1.51,"point":54.5},{"name":"Over","description":"Tee Higgins","price":1.22,"point":24.5},{"name":"Under","description":"Tee Higgins","price":3.85,"point":24.5},{"name":"Over","description":"Tee Higgins","price":1.33,"point":29.5},{"name":"Under","description":"Tee Higgins","price":3.1,"point":29.5},{"name":"Over","description":"Andrei Iosivas","price":1.5,"point":19.5},{"name":"Under","description":"Andrei Iosivas","price":2.45,"point":19.5},{"name":"Over","description":"Andrei Iosivas","price":1.77,"point":24.5},{"name":"Under","description":"Andrei Iosivas","price":2.0,"point":24.5},{"name":"Over","description":"Andrei Iosivas","price":3.0,"point":39.5},{"name":"Under","description":"Andrei Iosivas","price":1.34,"point":39.5},{"name":"Over","description":"Andrei Iosivas","price":2.5,"point":34.5},{"name":"Under","description":"Andrei Iosivas","price":1.49,"point":34.5},{"name":"Over","description":"Andrei Iosivas","price":2.1,"point":29.5},{"name":"Under","description":"Andrei Iosivas","price":1.7,"point":29.5},{"name":"Over","description":"Andrei Iosivas","price":3.7,"point":44.5},{"name":"Under","description":"Andrei Iosivas","price":1.24,"point":44.5},{"name":"Over","description":"Andrei Iosivas","price":1.88,"point":26.5},{"name":"Under","description":"Andrei Iosivas","price":1.87,"point":26.5},{"name":"Over","description":"Zach Ertz","price":1.91,"point":26.5},{"name":"Under","description":"Zach Ertz","price":1.85,"point":26.5}]},{"key":"player_rush_yds","last_update":"2024-09-22T02:06:59Z","outcomes":[{"name":"Over","description":"Zack Moss","price":1.87,"point":49.5},{"name":"Under","description":"Zack Moss","price":1.88,"point":49.5},{"name":"Over","description":"Jayden Daniels","price":1.88,"point":47.5},{"name":"Under","description":"Jayden Daniels","price":1.87,"point":47.5},{"name":"Over","description":"Brian Robinson Jr.","price":1.91,"point":52.5},{"name":"Under","description":"Brian Robinson Jr.","price":1.85,"point":52.5},{"name":"Over","description":"Chase Brown","price":1.89,"point":25.5},{"name":"Under","description":"Chase Brown","price":1.85,"point":25.5},{"name":"Over","description":"Joe Burrow","price":1.93,"point":12.5},{"name":"Under","description":"Joe Burrow","price":1.83,"point":12.5}]}]},{"key":"betonlineag","title":"BetOnline.ag","markets":[{"key":"player_pass_tds","last_update":"2024-09-22T02:07:41Z","outcomes":[{"name":"Under","description":"Joe Burrow","price":2.19,"point":1.5},{"name":"Over","description":"Joe Burrow","price":1.65,"point":1.5},{"name":"Under","description":"Jayden Daniels","price":1.39,"point":1.5},{"name":"Over","description":"Jayden Daniels","price":2.9,"point":1.5}]},{"key":"player_pass_yds","last_update":"2024-09-22T02:07:41Z","outcomes":[{"name":"Over","description":"Joe Burrow","price":1.99,"point":265.5},{"name":"Under","description":"Joe Burrow","price":1.78,"point":265.5},{"name":"Under","description":"Jayden Daniels","price":1.88,"point":196.5},{"name":"Over","description":"Jayden Daniels","price":1.88,"point":196.5}]},{"key":"player_reception_yds","last_update":"2024-09-22T02:07:41Z","outcomes":[{"name":"Over","description":"Zach Ertz","price":2.03,"point":27.5},{"name":"Under","description":"Zach Ertz","price":1.75,"point":27.5},{"name":"Over","description":"Brian Robinson Jr.","price":1.88,"point":11.5},{"name":"Under","description":"Brian Robinson Jr.","price":1.88,"point":11.5},{"name":"Over","description":"Terry McLaurin","price":1.86,"point":48.5},{"name":"Under","description":"Terry McLaurin","price":1.9,"point":48.5},{"name":"Under","description":"Ja\'Marr Chase","price":1.88,"point":82.5},{"name":"Over","description":"Ja\'Marr Chase","price":1.88,"point":82.5},{"name":"Under","description":"Tee Higgins","price":1.88,"point":45.5},{"name":"Over","description":"Tee Higgins","price":1.88,"point":45.5},{"name":"Over","description":"Andrei Iosivas","price":1.87,"point":26.5},{"name":"Under","description":"Andrei Iosivas","price":1.89,"point":26.5},{"name":"Under","description":"Chase Brown","price":1.88,"point":9.5},{"name":"Over","description":"Chase Brown","price":1.88,"point":9.5},{"name":"Under","description":"Mike Gesicki","price":1.88,"point":26.5},{"name":"Over","description":"Mike Gesicki","price":1.88,"point":26.5},{"name":"Over","description":"Zack Moss","price":1.84,"point":12.5},{"name":"Under","description":"Zack Moss","price":1.92,"point":12.5}]},{"key":"player_rush_yds","last_update":"2024-09-22T02:07:41Z","outcomes":[{"name":"Over","description":"Jayden Daniels","price":1.93,"point":50.5},{"name":"Under","description":"Jayden Daniels","price":1.83,"point":50.5},{"name":"Over","description":"Zack Moss","price":1.86,"point":51.5},{"name":"Under","description":"Zack Moss","price":1.9,"point":51.5},{"name":"Under","description":"Chase Brown","price":1.75,"point":25.5},{"name":"Over","description":"Chase Brown","price":2.03,"point":25.5},{"name":"Under","description":"Joe Burrow","price":1.84,"point":12.5},{"name":"Over","description":"Joe Burrow","price":1.92,"point":12.5},{"name":"Over","description":"Brian Robinson Jr.","price":1.88,"point":55.5},{"name":"Under","description":"Brian Robinson Jr.","price":1.88,"point":55.5}]}]},{"key":"betmgm","title":"BetMGM","markets":[{"key":"player_pass_tds","last_update":"2024-09-22T02:07:27Z","outcomes":[{"name":"Over","description":"Joe Burrow","price":1.69,"point":1.5},{"name":"Under","description":"Joe Burrow","price":2.1,"point":1.5},{"name":"Over","description":"Jayden Daniels","price":2.85,"point":1.5},{"name":"Under","description":"Jayden Daniels","price":1.4,"point":1.5}]},{"key":"player_pass_yds","last_update":"2024-09-22T02:07:27Z","outcomes":[{"name":"Over","description":"Joe Burrow","price":1.87,"point":264.5},{"name":"Under","description":"Joe Burrow","price":1.87,"point":264.5},{"name":"Over","description":"Jayden Daniels","price":1.87,"point":195.5},{"name":"Under","description":"Jayden Daniels","price":1.87,"point":195.5}]},{"key":"player_reception_yds","last_update":"2024-09-22T02:07:27Z","outcomes":[{"name":"Over","description":"Ja\'Marr Chase","price":1.83,"point":79.5},{"name":"Under","description":"Ja\'Marr Chase","price":1.91,"point":79.5},{"name":"Over","description":"Mike Gesicki","price":1.87,"point":28.5},{"name":"Under","description":"Mike Gesicki","price":1.87,"point":28.5},{"name":"Over","description":"Zach Ertz","price":1.95,"point":26.5},{"name":"Under","description":"Zach Ertz","price":1.8,"point":26.5},{"name":"Over","description":"Terry McLaurin","price":1.87,"point":46.5},{"name":"Under","description":"Terry McLaurin","price":1.87,"point":46.5},{"name":"Over","description":"Brian Robinson Jr.","price":1.91,"point":11.5},{"name":"Under","description":"Brian Robinson Jr.","price":1.83,"point":11.5},{"name":"Over","description":"Tee Higgins","price":1.87,"point":45.5},{"name":"Under","description":"Tee Higgins","price":1.87,"point":45.5},{"name":"Over","description":"Andrei Iosivas","price":1.91,"point":26.5},{"name":"Under","description":"Andrei Iosivas","price":1.83,"point":26.5},{"name":"Over","description":"Zack Moss","price":1.83,"point":12.5},{"name":"Under","description":"Zack Moss","price":1.91,"point":12.5}]},{"key":"player_rush_yds","last_update":"2024-09-22T02:07:27Z","outcomes":[{"name":"Over","description":"Joe Burrow","price":1.91,"point":12.5},{"name":"Under","description":"Joe Burrow","price":1.83,"point":12.5},{"name":"Over","description":"Zack Moss","price":1.87,"point":51.5},{"name":"Under","description":"Zack Moss","price":1.87,"point":51.5},{"name":"Over","description":"Jayden Daniels","price":1.83,"point":51.5},{"name":"Under","description":"Jayden Daniels","price":1.91,"point":51.5},{"name":"Over","description":"Chase Brown","price":1.87,"point":25.5},{"name":"Under","description":"Chase Brown","price":1.83,"point":25.5},{"name":"Over","description":"Brian Robinson Jr.","price":1.87,"point":53.5},{"name":"Under","description":"Brian Robinson Jr.","price":1.87,"point":53.5}]}]},{"key":"bovada","title":"Bovada","markets":[{"key":"player_reception_yds","last_update":"2024-09-22T02:07:36Z","outcomes":[{"name":"Over","description":"Andrei Iosivas","price":1.87,"point":26.5},{"name":"Under","description":"Andrei Iosivas","price":1.87,"point":26.5},{"name":"Over","description":"Brian Robinson Jr.","price":1.87,"point":11.5},{"name":"Under","description":"Brian Robinson Jr.","price":1.87,"point":11.5},{"name":"Over","description":"Ja\'Marr Chase","price":1.83,"point":79.5},{"name":"Under","description":"Ja\'Marr Chase","price":1.91,"point":79.5},{"name":"Over","description":"Mike Gesicki","price":1.87,"point":27.5},{"name":"Under","description":"Mike Gesicki","price":1.87,"point":27.5},{"name":"Over","description":"Tee Higgins","price":1.87,"point":45.5},{"name":"Under","description":"Tee Higgins","price":1.87,"point":45.5},{"name":"Over","description":"Terry McLaurin","price":1.8,"point":46.5},{"name":"Under","description":"Terry McLaurin","price":1.95,"point":46.5},{"name":"Over","description":"Zach Ertz","price":2.05,"point":27.5},{"name":"Under","description":"Zach Ertz","price":1.74,"point":27.5},{"name":"Over","description":"Zack Moss","price":1.83,"point":12.5},{"name":"Under","description":"Zack Moss","price":1.91,"point":12.5}]},{"key":"player_rush_yds","last_update":"2024-09-22T02:07:36Z","outcomes":[{"name":"Over","description":"Jayden Daniels","price":1.91,"point":52.5},{"name":"Under","description":"Jayden Daniels","price":1.83,"point":52.5},{"name":"Over","description":"Joe Burrow","price":1.95,"point":12.5},{"name":"Under","description":"Joe Burrow","price":1.8,"point":12.5},{"name":"Over","description":"Zack Moss","price":1.87,"point":51.5},{"name":"Under","description":"Zack Moss","price":1.87,"point":51.5}]}]}]}
    
    return event_odds
    



def get_all_event_odds(events, api_key=API_KEY):
    """
    Fetches player-specific odds for all upcoming NFL events (games).
    
    Args:
        api_key (str): TheOddsAPI key for authentication.
        events (list): List of events (games) with event IDs.
    
    Returns:
        dict: A dictionary containing player-specific odds for all games.
    """
    all_event_odds = {}
    
    for event in events:
        event_id = event['id']
        print(f"Fetching odds for event: {event['home_team']} vs {event['away_team']} (ID: {event_id})")
        event_odds = get_event_player_odds(event_id=event_id)
        
        if event_odds:
            all_event_odds[event_id] = event_odds  # Store odds by event ID

    return all_event_odds


def get_all_player_odds(all_event_odds):
    """
    Processes all event odds and returns a dictionary with player names as keys and their odds across markets.
    
    Args:
        all_event_odds (dict): A dictionary containing event-specific odds.
    
    Returns:
        dict: A dictionary where player names are the primary keys, and all known odds for all known markets are stored under their names.
    """
    player_odds_dict = {}

    # Iterate over each event's odds
    for event_id, event_odds in all_event_odds.items():
        for bookmaker in event_odds['bookmakers']:
            bookmaker_name = bookmaker['key']
            for market in bookmaker['markets']:
                market_key = market['key']  # e.g., player_pass_yds, player_rush_yds
                
                for outcome in market['outcomes']:
                    player_name = outcome['description']  # The player's name from the "description" field
                    point_value = outcome.get('point', None)  # Point (over/under threshold), if available
                    price = outcome['price']  # Odds value
                    outcome_type = outcome['name'].lower()  # Typically "Over" or "Under"

                    # Ensure player is added to the dictionary
                    if player_name not in player_odds_dict:
                        player_odds_dict[player_name] = {}

                    if bookmaker_name not in player_odds_dict[player_name]:
                        player_odds_dict[player_name][bookmaker_name] = {}

                    # Ensure the market is added for the player
                    if market_key not in player_odds_dict[player_name]:
                        player_odds_dict[player_name][bookmaker_name][market_key] = {"over": None, "under": None}

                    # Add odds for "over" or "under"
                    player_odds_dict[player_name][bookmaker_name][market_key][outcome_type] = {
                        "odds": price,
                        "point": point_value
                    }

    return player_odds_dict


try: 
    # events = get_nfl_events()
    events = [{'away_team': 'Washington Commanders',
  'commence_time': '2024-09-24T00:15:00Z',
  'home_team': 'Cincinnati Bengals',
  'id': '8e047915fdc9b7dc77d2276e740f55d2',
  'sport_key': 'americanfootball_nfl',
  'sport_title': 'NFL'}]
    all_event_odds = get_all_event_odds(events)
    all_player_odds = get_all_player_odds(all_event_odds)
    
    player_names = ["Joe Burrow", "Drake London", "Zach Charbonnet", "Sam LaPorta"]

    for player_name in player_names:
        if player_name in all_player_odds.keys():
            print(player_name + " Odds:")
            pprint(all_player_odds[player_name])

except requests.exceptions.RequestException as e:
        print(f"ERROR when making API request: {e}")
        print(f"URL Requested: {e.request.url}")
        print("Response:")
        pprint(e.response.json())



